/*!***************************************************
* mark.js v9.0.0
* https://markjs.io/
* Copyright (c) 2014–2021, Julian Kühnel
* Released under the MIT license https://git.io/vwTVl
*****************************************************/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Mark=t()}(this,function(){"use strict";class e{constructor(e,t=!0,r=[],s=5e3){this.ctx=e,this.iframes=t,this.exclude=r,this.iframesTimeout=s}static matches(e,t){const r="string"==typeof t?[t]:t,s=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;if(s){let t=!1;return r.every(r=>!s.call(e,r)||(t=!0,!1)),t}return!1}getContexts(){let e,t=[];return(e=void 0!==this.ctx&&this.ctx?NodeList.prototype.isPrototypeOf(this.ctx)?Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?this.ctx:"string"==typeof this.ctx?Array.prototype.slice.call(document.querySelectorAll(this.ctx)):[this.ctx]:[]).forEach(e=>{const r=t.filter(t=>t.contains(e)).length>0;-1!==t.indexOf(e)||r||t.push(e)}),t}getIframeContents(e,t,r=(()=>{})){let s;try{const t=e.contentWindow;if(s=t.document,!t||!s)throw new Error("iframe inaccessible")}catch(e){r()}s&&t(s)}isIframeBlank(e){const t="about:blank",r=e.getAttribute("src").trim();return e.contentWindow.location.href===t&&r!==t&&r}observeIframeLoad(e,t,r){let s=!1,i=null;const o=()=>{if(!s){s=!0,clearTimeout(i);try{this.isIframeBlank(e)||(e.removeEventListener("load",o),this.getIframeContents(e,t,r))}catch(e){r()}}};e.addEventListener("load",o),i=setTimeout(o,this.iframesTimeout)}onIframeReady(e,t,r){try{"complete"===e.contentWindow.document.readyState?this.isIframeBlank(e)?this.observeIframeLoad(e,t,r):this.getIframeContents(e,t,r):this.observeIframeLoad(e,t,r)}catch(e){r()}}waitForIframes(e,t){let r=0;this.forEachIframe(e,()=>!0,e=>{r++,this.waitForIframes(e.querySelector("html"),()=>{--r||t()})},e=>{e||t()})}forEachIframe(t,r,s,i=(()=>{})){let o=t.querySelectorAll("iframe"),n=o.length,a=0;o=Array.prototype.slice.call(o);const h=()=>{--n<=0&&i(a)};n||h(),o.forEach(t=>{e.matches(t,this.exclude)?h():this.onIframeReady(t,e=>{r(t)&&(a++,s(e)),h()},h)})}createIterator(e,t,r){return document.createNodeIterator(e,t,r,!1)}createInstanceOnIframe(t){return new e(t.querySelector("html"),this.iframes)}compareNodeIframe(e,t,r){if(e.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_PRECEDING){if(null===t)return!0;if(t.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_FOLLOWING)return!0}return!1}getIteratorNode(e){const t=e.previousNode();let r;return{prevNode:t,node:r=null===t?e.nextNode():e.nextNode()&&e.nextNode()}}checkIframeFilter(e,t,r,s){let i=!1,o=!1;return s.forEach((e,t)=>{e.val===r&&(i=t,o=e.handled)}),this.compareNodeIframe(e,t,r)?(!1!==i||o?!1===i||o||(s[i].handled=!0):s.push({val:r,handled:!0}),!0):(!1===i&&s.push({val:r,handled:!1}),!1)}handleOpenIframes(e,t,r,s){e.forEach(e=>{e.handled||this.getIframeContents(e.val,e=>{this.createInstanceOnIframe(e).forEachNode(t,r,s)})})}iterateThroughNodes(e,t,r,s,i){const o=this.createIterator(t,e,s);let n,a,h=[],l=[];for(;n=o.nextNode();)this.iframes&&this.forEachIframe(t,e=>this.checkIframeFilter(n,a,e,h),t=>{this.createInstanceOnIframe(t).forEachNode(e,e=>l.push(e),s)}),l.push(n),a=n;l.forEach(e=>{r(e)}),this.iframes&&this.handleOpenIframes(h,e,r,s),i()}forEachNode(e,t,r,s=(()=>{})){const i=this.getContexts();let o=i.length;o||s(),i.forEach(i=>{const n=()=>{this.iterateThroughNodes(e,i,t,r,()=>{--o<=0&&s()})};this.iframes?this.waitForIframes(i,n):n()})}}class t{constructor(e){this.opt=Object.assign({},{diacritics:!0,synonyms:{},accuracy:"partially",caseSensitive:!1,ignoreJoiners:!1,ignorePunctuation:[],wildcards:"disabled"},e)}create(e){return"disabled"!==this.opt.wildcards&&(e=this.setupWildcardsRegExp(e)),e=this.escapeStr(e),Object.keys(this.opt.synonyms).length&&(e=this.createSynonymsRegExp(e)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),this.opt.diacritics&&(e=this.createDiacriticsRegExp(e)),e=this.createMergedBlanksRegExp(e),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.createJoinersRegExp(e)),"disabled"!==this.opt.wildcards&&(e=this.createWildcardsRegExp(e)),e=this.createAccuracyRegExp(e),new RegExp(e,`gm${this.opt.caseSensitive?"":"i"}`)}sortByLength(e){return e.sort((e,t)=>e.length===t.length?e>t?1:-1:t.length-e.length)}escapeStr(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}createSynonymsRegExp(e){const t=this.opt.synonyms,r=this.opt.caseSensitive?"":"i",s=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(let i in t)if(t.hasOwnProperty(i)){let o=Array.isArray(t[i])?t[i]:[t[i]];o.unshift(i),(o=this.sortByLength(o).map(e=>("disabled"!==this.opt.wildcards&&(e=this.setupWildcardsRegExp(e)),e=this.escapeStr(e))).filter(e=>""!==e)).length>1&&(e=e.replace(new RegExp(`(${o.map(e=>this.escapeStr(e)).join("|")})`,`gm${r}`),s+`(${o.map(e=>this.processSynonyms(e)).join("|")})`+s))}return e}processSynonyms(e){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),e}setupWildcardsRegExp(e){return(e=e.replace(/(?:\\)*\?/g,e=>"\\"===e.charAt(0)?"?":"")).replace(/(?:\\)*\*/g,e=>"\\"===e.charAt(0)?"*":"")}createWildcardsRegExp(e){let t="withSpaces"===this.opt.wildcards;return e.replace(/\u0001/g,t?"[\\S\\s]?":"\\S?").replace(/\u0002/g,t?"[\\S\\s]*?":"\\S*")}setupIgnoreJoinersRegExp(e){return e.replace(/[^(|)\\]/g,(e,t,r)=>{let s=r.charAt(t+1);return/[(|)\\]/.test(s)||""===s?e:e+"\0"})}createJoinersRegExp(e){let t=[];const r=this.opt.ignorePunctuation;return Array.isArray(r)&&r.length&&t.push(this.escapeStr(r.join(""))),this.opt.ignoreJoiners&&t.push("\\u00ad\\u200b\\u200c\\u200d"),t.length?e.split(/\u0000+/).join(`[${t.join("")}]*`):e}createDiacriticsRegExp(e){const t=this.opt.caseSensitive?"":"i",r=this.opt.caseSensitive?["aàáảãạăằắẳẵặâầấẩẫậäåāą","AÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćč","CÇĆČ","dđď","DĐĎ","eèéẻẽẹêềếểễệëěēę","EÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïī","IÌÍỈĨỊÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøō","OÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rř","RŘ","sšśșş","SŠŚȘŞ","tťțţ","TŤȚŢ","uùúủũụưừứửữựûüůū","UÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿ","YÝỲỶỸỴŸ","zžżź","ZŽŻŹ"]:["aàáảãạăằắẳẵặâầấẩẫậäåāąAÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćčCÇĆČ","dđďDĐĎ","eèéẻẽẹêềếểễệëěēęEÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïīIÌÍỈĨỊÎÏĪ","lłLŁ","nñňńNÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøōOÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rřRŘ","sšśșşSŠŚȘŞ","tťțţTŤȚŢ","uùúủũụưừứửữựûüůūUÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿYÝỲỶỸỴŸ","zžżźZŽŻŹ"];let s=[];return e.split("").forEach(i=>{r.every(r=>{if(-1!==r.indexOf(i)){if(s.indexOf(r)>-1)return!1;e=e.replace(new RegExp(`[${r}]`,`gm${t}`),`[${r}]`),s.push(r)}return!0})}),e}createMergedBlanksRegExp(e){return e.replace(/[\s]+/gim,"[\\s]+")}createAccuracyRegExp(e){let t=this.opt.accuracy,r="string"==typeof t?t:t.value,s="string"==typeof t?[]:t.limiters,i="";switch(s.forEach(e=>{i+=`|${this.escapeStr(e)}`}),r){case"partially":default:return`()(${e})`;case"complementary":return`()([^${i="\\s"+(i||this.escapeStr("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~¡¿"))}]*${e}[^${i}]*)`;case"exactly":return`(^|\\s${i})(${e})(?=$|\\s${i})`}}}class r{constructor(e){this.ctx=e,this.ie=!1;const t=window.navigator.userAgent;(t.indexOf("MSIE")>-1||t.indexOf("Trident")>-1)&&(this.ie=!0)}set opt(e){this._opt=Object.assign({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,acrossElements:!1,ignoreGroups:0,each:()=>{},noMatch:()=>{},filter:()=>!0,done:()=>{},debug:!1,log:window.console},e)}get opt(){return this._opt}get iterator(){return new e(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}log(e,t="debug"){const r=this.opt.log;this.opt.debug&&"object"==typeof r&&"function"==typeof r[t]&&r[t](`mark.js: ${e}`)}getSeparatedKeywords(e){let t=[];return e.forEach(e=>{this.opt.separateWordSearch?e.split(" ").forEach(e=>{e.trim()&&-1===t.indexOf(e)&&t.push(e)}):e.trim()&&-1===t.indexOf(e)&&t.push(e)}),{keywords:t.sort((e,t)=>t.length-e.length),length:t.length}}isNumeric(e){return Number(parseFloat(e))==e}checkRanges(e){if(!Array.isArray(e)||"[object Object]"!==Object.prototype.toString.call(e[0]))return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(e),[];const t=[];let r=0;return e.sort((e,t)=>e.start-t.start).forEach(e=>{let{start:s,end:i,valid:o}=this.callNoMatchOnInvalidRanges(e,r);o&&(e.start=s,e.length=i-s,t.push(e),r=i)}),t}callNoMatchOnInvalidRanges(e,t){let r,s,i=!1;return e&&void 0!==e.start?(s=(r=parseInt(e.start,10))+parseInt(e.length,10),this.isNumeric(e.start)&&this.isNumeric(e.length)&&s-t>0&&s-r>0?i=!0:(this.log("Ignoring invalid or overlapping range: "+`${JSON.stringify(e)}`),this.opt.noMatch(e))):(this.log(`Ignoring invalid range: ${JSON.stringify(e)}`),this.opt.noMatch(e)),{start:r,end:s,valid:i}}checkWhitespaceRanges(e,t,r){let s,i=!0,o=r.length,n=t-o,a=parseInt(e.start,10)-n;return(s=(a=a>o?o:a)+parseInt(e.length,10))>o&&(s=o,this.log(`End range automatically set to the max value of ${o}`)),a<0||s-a<0||a>o||s>o?(i=!1,this.log(`Invalid range: ${JSON.stringify(e)}`),this.opt.noMatch(e)):""===r.substring(a,s).replace(/\s+/g,"")&&(i=!1,this.log("Skipping whitespace only range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:a,end:s,valid:i}}checkParents(e,t){let r=0;if(e===e.parentNode.lastChild){if(r=t[e.parentNode.nodeName.toLowerCase()])return r;{let s=e.parentNode;for(;s===s.parentNode.lastChild;){if(r=t[s.parentNode.nodeName.toLowerCase()])return r;s=s.parentNode}}let s=e.parentNode.nextSibling;if(s&&1===s.nodeType&&(r=t[s.nodeName.toLowerCase()]))return r}return-1}checkNextNodes(e,t){let r=0;if(e&&1===e.nodeType){if(r=t[e.nodeName.toLowerCase()])return r;if(e.firstChild){let s,i=e.firstChild;for(;i;){if(1!==i.nodeType)return-1;if(r=t[i.nodeName.toLowerCase()])return r;s=i,i=i.firstChild}return this.checkNextNodes(s.nextSibling,t)}if(e!==e.parentNode.lastChild)return this.checkNextNodes(e.nextSibling,t);if(r=t[e.parentNode.nodeName.toLowerCase()])return r}return-1}getTextNodesAcrossElements(e){let t,r,s,i,o,n="",a=[],h=this.opt.boundaryChar?this.opt.boundaryChar.charAt(0)+" ":" ",l=" "+h,c={div:1,p:1,li:1,td:1,tr:1,th:1,ul:1,ol:1,br:1,dd:1,dl:1,dt:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,blockquote:1,figcaption:1,figure:1,pre:1,table:1,thead:1,tbody:1,tfoot:1,input:1,img:1,nav:1,details:1,label:1,form:1,select:1,menu:1,menuitem:1,main:1,section:1,article:1,aside:1,picture:1,output:1,button:1,header:1,footer:1,address:1,area:1,canvas:1,map:1,fieldset:1,textarea:1,track:1,video:1,audio:1,body:1,iframe:1,meter:1,object:1,svg:1};if(this.opt.blockElementsBoundary)if(this.opt.blockElements&&this.opt.blockElements.length){let e={};for(let t in this.opt.blockElements)e[this.opt.blockElements[t].toLowerCase()]=1;for(let t in e)c[t]=2}else{for(let e in c)c[e]=2;c.br=1}this.iterator.forEachNode(NodeFilter.SHOW_TEXT,e=>{o=0,t=n.length,r=e.textContent,s=/\s/.test(r[r.length-1]),!this.opt.blockElementsBoundary&&s||(-1===(i=this.checkParents(e,c))&&(i=this.checkNextNodes(e.nextSibling,c)),i>0&&(s?2===i&&(n+=r+h,o=2):1===i?(n+=r+" ",o=1):2===i&&(n+=r+l,o=3))),0===o&&(n+=r),a.push({start:t,end:n.length-o,offset:o,node:e})},e=>this.matchesExclude(e.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT,()=>{e({value:n,nodes:a,lastIndex:0})})}getTextNodes(e){let t="",r=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,e=>{r.push({start:t.length,end:(t+=e.textContent).length,node:e})},e=>this.matchesExclude(e.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT,()=>{e({value:t,nodes:r,lastIndex:0})})}matchesExclude(t){return e.matches(t,this.opt.exclude.concat(["script","style","title","head","html"]))}wrapRangeInTextNode(e,t,r){const s=this.opt.element?this.opt.element:"mark",i=e.splitText(t),o=i.splitText(r-t);let n=document.createElement(s);return n.setAttribute("data-markjs","true"),this.opt.className&&n.setAttribute("class",this.opt.className),n.textContent=i.textContent,i.parentNode.replaceChild(n,i),o}wrapRangeInMappedTextNode(e,t,r,s,i){let o=!0;for(let n=e.lastIndex;n<e.nodes.length;n++){const a=e.nodes[n+1];if(void 0===a||a.start>t){let a=e.nodes[n];if(!s(a.node)){n>e.lastIndex&&(e.lastIndex=n);break}const h=t-a.start,l=(r>a.end?a.end:r)-a.start;if(l>h&&(a.node=this.wrapRangeInTextNode(a.node,h,l),a.start+=l,i(a.node.previousSibling,o),o=!1),!(r>a.end)){e.lastIndex=n;break}t=a.end+(a.offset?a.offset:0)}}}wrapGroups(e,t,r,s){return s((e=this.wrapRangeInTextNode(e,t,t+r)).previousSibling),e}separateGroups(e,t,r,s,i){let o=t.length;for(let r=1;r<o;r++){let o=e.textContent.indexOf(t[r]);t[r]&&o>-1&&s(t[r],e)&&(e=this.wrapGroups(e,o,t[r].length,i))}return e}wrapMatchGroups(e,t,r,s,i){let o,n,a,h,l=!0,c=0,p=1;for(;p<t.length;p++)(o=t[p])&&(n=t.indices[p][0])>=c&&(a=t.indices[p][1],h=!1,this.wrapRangeInMappedTextNode(e,n,a,e=>s(o,e,p),(e,t)=>{h=!0,i(e,l,t,p),l=!1}),h&&a>c&&(c=a))}wrapMatchGroups2(e,t,r,s,i){let o,n,a,h=!0,l=0,c=1;const p=t.index,d=e.value.substring(p,r.lastIndex);for(;c<t.length;c++)(o=t[c])&&(a=(n=d.indexOf(o,l))+o.length,-1!==n&&(this.wrapRangeInMappedTextNode(e,p+n,p+a,e=>s(o,e,c),(e,t)=>{i(e,h,t,c),h=!1}),l=a))}wrapMatches(e,t,r,s,i){const o=0===t?0:t+1;this.getTextNodes(t=>{t.nodes.forEach(t=>{let i;for(t=t.node;null!==(i=e.exec(t.textContent))&&""!==i[o];){if(this.opt.separateGroups&&1!==i.length)t=this.separateGroups(t,i,o,r,s);else{if(!r(i[o],t))continue;let e=i.index;if(0!==o)for(let t=1;t<o;t++)e+=i[t].length;t=this.wrapGroups(t,e,i[o].length,s)}e.lastIndex=0}}),i()})}wrapMatchesAcrossElements(e,t,r,s,i){const o=0===t||this.opt.separateGroups?0:t+1;let n,a;this.getTextNodesAcrossElements(t=>{for(;null!==(n=e.exec(t.value))&&""!==n[o];)if(a=-1,this.opt.separateGroups){this[e.hasIndices?"wrapMatchGroups":"wrapMatchGroups2"](t,n,e,(e,t,s)=>r(e,t,{match:n,matchStart:0==++a,groupIndex:s}),(e,t,r,i)=>{s(e,{match:n,matchStart:t,groupIndex:i,groupStart:r})})}else{let i=n.index;if(0!==o)for(let e=1;e<o;e++)i+=n[e].length;const h=i+n[o].length;this.wrapRangeInMappedTextNode(t,i,h,t=>r(n[o],t,{regex:e,match:n,matchStart:0==++a}),(e,t)=>{s(e,{match:n,matchStart:t})})}i()})}wrapRangeFromIndex(e,t,r,s){this.getTextNodes(i=>{const o=i.value.length;e.forEach((e,s)=>{let{start:n,end:a,valid:h}=this.checkWhitespaceRanges(e,o,i.value);h&&this.wrapRangeInMappedTextNode(i,n,a,r=>t(r,e,i.value.substring(n,a),s),t=>{r(t,e)})}),s()})}unwrapMatches(e){const t=e.parentNode;let r=document.createDocumentFragment();for(;e.firstChild;)r.appendChild(e.removeChild(e.firstChild));t.replaceChild(r,e),this.ie?this.normalizeTextNode(t):t.normalize()}normalizeTextNode(e){if(e){if(3===e.nodeType)for(;e.nextSibling&&3===e.nextSibling.nodeType;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);else this.normalizeTextNode(e.firstChild);this.normalizeTextNode(e.nextSibling)}}markRegExp(e,t){this.opt=t;let r=0,s="wrapMatches";if(this.opt.acrossElements&&(s="wrapMatchesAcrossElements",!e.global&&!e.sticky)){let t=e.toString().split("/"),r="g"+t[t.length-1];e=new RegExp(e.source,r),this.log("RegExp is recompiled with g flag because it must have g flag")}this.log(`Searching with expression "${e}"`),this[s](e,this.opt.ignoreGroups,(e,t,s)=>this.opt.filter(t,e,r,s),(e,t)=>{r++,this.opt.each(e,t)},()=>{0===r&&this.opt.noMatch(e),this.opt.done(r)})}mark(e,r){this.opt=r;let s=0,i="wrapMatches";const{keywords:o,length:n}=this.getSeparatedKeywords("string"==typeof e?[e]:e),a=e=>{const r=new t(this.opt).create(e);let h=0;this.log(`Searching with expression "${r}"`),this[i](r,1,(t,r,i)=>this.opt.filter(r,e,s,h,i),(e,t)=>{h++,s++,this.opt.each(e,t)},()=>{0===h&&this.opt.noMatch(e),o[n-1]===e?this.opt.done(s):a(o[o.indexOf(e)+1])})};this.opt.acrossElements&&(i="wrapMatchesAcrossElements"),0===n?this.opt.done(s):a(o[0])}markRanges(e,t){this.opt=t;let r=0,s=this.checkRanges(e);s&&s.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(s)),this.wrapRangeFromIndex(s,(e,t,r,s)=>this.opt.filter(e,t,r,s),(e,t)=>{r++,this.opt.each(e,t)},()=>{this.opt.done(r)})):this.opt.done(r)}unmark(t){this.opt=t;let r=this.opt.element?this.opt.element:"*";r+="[data-markjs]",this.opt.className&&(r+=`.${this.opt.className}`),this.log(`Removal selector "${r}"`),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,e=>{this.unwrapMatches(e)},t=>{const s=e.matches(t,r),i=this.matchesExclude(t);return!s||i?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},this.opt.done)}}return function(e){const t=new r(e);return this.mark=((e,r)=>(t.mark(e,r),this)),this.markRegExp=((e,r)=>(t.markRegExp(e,r),this)),this.markRanges=((e,r)=>(t.markRanges(e,r),this)),this.unmark=(e=>(t.unmark(e),this)),this}});
